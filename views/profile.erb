<section class="pro_container">
  <article class="row">
    <div class="profile_img" style="background-image: url('https://cdn2.iconfinder.com/data/icons/rcons-user/32/male-circle-512.png'); background-size: cover;">
    </div>
    <div class="slideshow">
      <div class="slideshow_wrapper">
        <ul id="slider">
          <li><img src="http://4d663a369f9f03c3c61e-870e77779efd63f7bd6c2ee08d8cfae6.r2.cf1.rackcdn.com/images/gyO04SLxg8Fq.840x0.Vdef9Kkm.jpg" alt="" /></li>
          <li><img src="http://www.gameondaily.com/wordpress/wp-content/uploads/2015/05/2864036-assassins_creed_syndicate_gang_leader-1200x666.jpg" alt="" /></li>
          <li><img src="http://www.gamerheadlines.com/wp-content/uploads/2015/05/AC-Syndicate-111.jpg" alt="" /></li>
          <li><img src="http://cdn.mos.techradar.com/art/games/Fallout%204/E3%20press/Fallout4_E3_Workshop_1434324024-970-80.jpg" alt="" /></li>
          <li><img src="http://i.kinja-img.com/gawker-media/image/upload/s--sJUncsSs--/c_fit,f_auto,fl_progressive,q_80,w_636/1297830977926445345.gif" alt="" /></li>
          <li><img src="https://s3-us-west-1.amazonaws.com/shacknews/assets/editorial/2015/11/dogmeat.jpg" alt="" /></li>
        </ul>
      </div>
    </div>
  </article>
  <article class="row contents" style="z-index: -1; position: relative;">
    <div class="profile_props">
      <div id="props">
        <p>
          <%= params[:user_name] %> is <span style="color:#00ff00;">Online</span>
        </p>
      </div>
    </div>
    <div class="profile-comments">
      <div class="form-container">
        <form class="comment-post" action="/profile/<%= @user_name %>" method="post">
          <input type="hidden" name="account_id" value="<%= @id %>">
          <textarea name="comment" rows="6" cols="40" placeholder="Post comments here..."></textarea>
          <input type="submit" id="post-btn" value="Post">
        </form>
      </div>
      <div id="posts-container">
        <% @comments.each do |comment| %>
          <%= "<div class='posts'><p id='timestamp'>#{comment.date_created}</p><p id='comments'>#{comment.comment}</p><hr></div>" %>
        <% end %>
      </div>
    </div>
  </article>


</section>

<!-- <%= session[:message] %> -->
<script type="text/javascript">
console.log("<%= @user_name %>");
console.log("<%= @id %>");
console.log("<%= @timestamp %>");
//------------------------------ Image Slider --------------------------------//

  var ul;
  var listItems;
  var numOfImgs;
  var imgWidth;
  var currentImage;

  function init() {
    ul = document.getElementById('slider');
    listItems = ul.children;
    numOfImgs = listItems.length;
    imgWidth = listItems[0].children[0].offsetWidth;
    ul.style.width = parseInt(imgWidth * numOfImgs) + "px";
    slider(ul);
  }

  function slider(ul) {
    animate({
      delay : 17,
      duration : 3000,
      delta : function(p) {
        return Math.max(0, -1 + 2 * p);
      },
      step : function(delta) {
        ul.style.left = '-' + parseInt(currentImage * imgWidth + delta * imgWidth) + "px";
      },
      callback : function() {
        currentImage++;
        if (currentImage < numOfImgs - 1) {
          slider(ul);
        } else {
          var leftPosition = (numOfImgs - 1 * imgWidth);
          setTimeout(function() {goBack(leftPosition)}, 2000);
          setTimeout(function() {slider(ul)}, 4000);
        }
      }
    });
  }

  function goBack(leftposition) {
    currentImage = 0;
    var id = setInterval(function() {
      if (leftposition >= 0) {
        ul.style.left = '-' + parseInt(leftposition) + "px";
        leftposition -= imgWidth / 10;
      } else {
        clearInterval(id);
      }
    });
  }

  function animate(opts) {
    var start = new Date;
    var id = setInterval(function() {
      var timePassed = new Date - start;
      var progress = timePassed / opts.duration;
      if (progress > 1) {
        progress = 1;
      }
      var delta = opts.delta(progress);
      opts.step(delta);
      if (progress == 1) {
        clearInterval(id);
        opts.callback();
      }
    }, opts.delay || 17);
  }

  window.onload = init();
//----------------------------------------------------------------------------//

//---------------------- Comment Poster (javascript) -------------------------//



  // var postButton = document.getElementById('post-btn');
  // postButton.addEventListener('submit', function() {
  //   var posts = document.createElement('div');
  //   posts.className = "posts";
  //   var hr = document.createElement('hr');
  //   posts.appendChild(hr);
  //   var time = document.createElement('p');
  //   time.id = "timestamp";
  //   var date = new Date();
  //   time.innerHTML = date.toLocaleString();
  //   posts.appendChild(time);
  //   var comment = document.createElement('p');
  //   comment.id = "comments";
  //   var formComments = document.getElementsByName('comment')[0].value;
  //   comment.innerText = formComments;
  //   posts.appendChild(comment);
  //   posts.appendChild(hr);
  //   var container = document.getElementById('posts-container');
  //   container.appendChild(posts);
  //   document.getElementsByName('comment')[0].value = "";
  // });

//----------------------------------------------------------------------------//

  document.getElementById('logout_btn').style.display = "<%= session[:logged] %>";
  document.getElementById('register_btn').style.display = "<%= session[:signup] %>";
</script>
